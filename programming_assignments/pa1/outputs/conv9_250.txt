
Config:
Samples per class: 250
Model: conv9


Loading training and test sets...





Train_y shape: 
 (50000, 200)
Test_y shape: 
 (10000, 200)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 62, 62, 64)        1792      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 31, 31, 64)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 31, 31, 64)        256       
_________________________________________________________________
zero_padding2d_1 (ZeroPaddin (None, 33, 33, 64)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 31, 31, 128)       73856     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 16, 128)       0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 16, 128)       512       
_________________________________________________________________
zero_padding2d_2 (ZeroPaddin (None, 18, 18, 128)       0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 16, 256)       295168    
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 8, 8, 256)         0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 8, 8, 256)         1024      
_________________________________________________________________
zero_padding2d_3 (ZeroPaddin (None, 10, 10, 256)       0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 8, 512)         1180160   
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 4, 4, 512)         0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 4, 4, 512)         2048      
_________________________________________________________________
zero_padding2d_4 (ZeroPaddin (None, 6, 6, 512)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 4, 4, 1024)        4719616   
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 2, 2, 1024)        0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 2, 2, 1024)        4096      
_________________________________________________________________
zero_padding2d_5 (ZeroPaddin (None, 4, 4, 1024)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 2, 2, 512)         4719104   
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 1, 1, 512)         0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 1, 1, 512)         2048      
_________________________________________________________________
zero_padding2d_6 (ZeroPaddin (None, 3, 3, 512)         0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 1, 1, 256)         1179904   
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 1, 1, 256)         0         
_________________________________________________________________
batch_normalization_7 (Batch (None, 1, 1, 256)         1024      
_________________________________________________________________
zero_padding2d_7 (ZeroPaddin (None, 3, 3, 256)         0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 1, 1, 128)         295040    
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
batch_normalization_8 (Batch (None, 1, 1, 128)         512       
_________________________________________________________________
zero_padding2d_8 (ZeroPaddin (None, 3, 3, 128)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 1, 1, 64)          73792     
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 1, 1, 64)          0         
_________________________________________________________________
batch_normalization_9 (Batch (None, 1, 1, 64)          256       
_________________________________________________________________
zero_padding2d_9 (ZeroPaddin (None, 3, 3, 64)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 576)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               295424    
_________________________________________________________________
dense_2 (Dense)              (None, 200)               102600    
=================================================================
Total params: 12,948,232
Trainable params: 12,942,344
Non-trainable params: 5,888
_________________________________________________________________
None


9 Conv layer model
Train on 45000 samples, validate on 5000 samples
Epoch 1/15
 - 35s - loss: 4.8032 - accuracy: 0.0363 - val_loss: 5.0976 - val_accuracy: 0.0440
Epoch 2/15
 - 31s - loss: 4.2898 - accuracy: 0.0793 - val_loss: 4.5451 - val_accuracy: 0.0744
Epoch 3/15
 - 31s - loss: 3.9455 - accuracy: 0.1226 - val_loss: 3.9883 - val_accuracy: 0.1326
Epoch 4/15
 - 32s - loss: 3.6558 - accuracy: 0.1640 - val_loss: 3.7855 - val_accuracy: 0.1628
Epoch 5/15
 - 32s - loss: 3.3882 - accuracy: 0.2038 - val_loss: 3.5913 - val_accuracy: 0.1930
Epoch 6/15
 - 32s - loss: 3.1013 - accuracy: 0.2545 - val_loss: 3.4870 - val_accuracy: 0.2106
Epoch 7/15
 - 32s - loss: 2.7379 - accuracy: 0.3183 - val_loss: 3.4176 - val_accuracy: 0.2332
Epoch 8/15
 - 32s - loss: 2.2543 - accuracy: 0.4073 - val_loss: 3.7485 - val_accuracy: 0.2338
Epoch 9/15
 - 32s - loss: 1.7288 - accuracy: 0.5253 - val_loss: 4.0055 - val_accuracy: 0.2338
Epoch 10/15
 - 32s - loss: 1.2471 - accuracy: 0.6388 - val_loss: 4.4255 - val_accuracy: 0.2256
Epoch 11/15
 - 31s - loss: 0.8775 - accuracy: 0.7372 - val_loss: 5.2179 - val_accuracy: 0.2074
Epoch 12/15
 - 31s - loss: 0.6211 - accuracy: 0.8096 - val_loss: 5.5225 - val_accuracy: 0.2336
Epoch 13/15
 - 31s - loss: 0.5036 - accuracy: 0.8433 - val_loss: 6.0423 - val_accuracy: 0.2284
Epoch 14/15
 - 31s - loss: 0.3927 - accuracy: 0.8755 - val_loss: 6.3025 - val_accuracy: 0.2234
Epoch 15/15
 - 31s - loss: 0.3705 - accuracy: 0.8815 - val_loss: 6.7182 - val_accuracy: 0.2122


Total training time taken (mins:sec): 7:58.00



9 Conv Layer model predictions:


Predicting on test set...

   32/10000 [..............................] - ETA: 2:33
  288/10000 [..............................] - ETA: 18s 
  512/10000 [>.............................] - ETA: 11s
  736/10000 [=>............................] - ETA: 8s 
  960/10000 [=>............................] - ETA: 6s
 1152/10000 [==>...........................] - ETA: 5s
 1344/10000 [===>..........................] - ETA: 5s
 1504/10000 [===>..........................] - ETA: 4s
 1664/10000 [===>..........................] - ETA: 4s
 1856/10000 [====>.........................] - ETA: 4s
 2048/10000 [=====>........................] - ETA: 4s
 2240/10000 [=====>........................] - ETA: 3s
 2432/10000 [======>.......................] - ETA: 3s
 2624/10000 [======>.......................] - ETA: 3s
 2816/10000 [=======>......................] - ETA: 3s
 3008/10000 [========>.....................] - ETA: 3s
 3168/10000 [========>.....................] - ETA: 3s
 3360/10000 [=========>....................] - ETA: 2s
 3552/10000 [=========>....................] - ETA: 2s
 3744/10000 [==========>...................] - ETA: 2s
 3936/10000 [==========>...................] - ETA: 2s
 4128/10000 [===========>..................] - ETA: 2s
 4320/10000 [===========>..................] - ETA: 2s
 4512/10000 [============>.................] - ETA: 2s
 4704/10000 [=============>................] - ETA: 2s
 4896/10000 [=============>................] - ETA: 2s
 5088/10000 [==============>...............] - ETA: 1s
 5280/10000 [==============>...............] - ETA: 1s
 5472/10000 [===============>..............] - ETA: 1s
 5696/10000 [================>.............] - ETA: 1s
 5888/10000 [================>.............] - ETA: 1s
 6080/10000 [=================>............] - ETA: 1s
 6272/10000 [=================>............] - ETA: 1s
 6464/10000 [==================>...........] - ETA: 1s
 6656/10000 [==================>...........] - ETA: 1s
 6848/10000 [===================>..........] - ETA: 1s
 7040/10000 [====================>.........] - ETA: 1s
 7232/10000 [====================>.........] - ETA: 0s
 7424/10000 [=====================>........] - ETA: 0s
 7616/10000 [=====================>........] - ETA: 0s
 7808/10000 [======================>.......] - ETA: 0s
 8000/10000 [=======================>......] - ETA: 0s
 8192/10000 [=======================>......] - ETA: 0s
 8384/10000 [========================>.....] - ETA: 0s
 8576/10000 [========================>.....] - ETA: 0s
 8768/10000 [=========================>....] - ETA: 0s
 8960/10000 [=========================>....] - ETA: 0s
 9152/10000 [==========================>...] - ETA: 0s
 9344/10000 [===========================>..] - ETA: 0s
 9536/10000 [===========================>..] - ETA: 0s
 9728/10000 [============================>.] - ETA: 0s
 9888/10000 [============================>.] - ETA: 0s
10000/10000 [==============================] - 4s 372us/step

Predicted Class Indices: 

[113 170 179 ... 190  54  31]
Num predictions:  10000

Test set accuracy: 20.64%
